"use strict";function e(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}function t(e){return"function"==typeof e?e():e}function n(e){return!c(e)&&(o(e)||i(e)||a(e))}function o(e){return e.hasOwnProperty("action")}function i(e){return e.hasOwnProperty("href")}function r(e){return e.hasOwnProperty("isDivider")}function a(e){return e.hasOwnProperty("subMenu")}function c(e){return e.hasOwnProperty("html")||e.hasOwnProperty("element")}function d(e){return!n(e)&&!r(e)&&!c(e)}function u(e){return n(e)&&t(e.disabled)||a(e)&&0===t(e.subMenu).length}function s(e,t){var n;e.addEventListener("mouseenter",(function(e){n=setTimeout((function(){return t(e)}),150)})),e.addEventListener("mouseleave",(function(){return clearTimeout(n)}))}function l(e,n){var o,i=e.html,r=e.text,a=t(e.element);a?n.append(a):n.innerHTML=null!==(o=t(i))&&void 0!==o?o:"<span>".concat(t(r),"</span>")}function h(e,n){var o=e.tooltip,i=e.style;n.title=t(o)||"",i&&n.setAttribute("style",t(i))}function f(e,n){var o=e.icon;o&&(n.innerHTML+='<img class="icon" src="'.concat(t(o),'" />'))}function p(e,n){for(var i=0,r=Object.entries(t(e.events)||{});i<r.length;i++){var a=r[i],c=a[0],d=a[1],s="function"==typeof d?{listener:d,options:{}}:d,l=s.listener,h=s.options;n.addEventListener(c,l,h)}o(e)&&!u(e)&&n.addEventListener("click",e.action)}function m(e,n){if(i(e)&&!u(e)){var o=e.href,r=e.download,a=e.target,c=document.createElement("a");c.innerHTML=n.innerHTML,c.href=t(o),void 0!==r&&(c.download=t(r)),a&&(c.target=t(a)),n.replaceChildren(c)}}Object.defineProperty(exports,"__esModule",{value:!0}),"function"==typeof SuppressedError&&SuppressedError;var v="r",y="d";function x(e,t){var n=w(),o=window.visualViewport,i=o.width,r=o.height;Object.assign(e.style,{maxHeight:r/n.y+"px",maxWidth:i/n.x+"px"});var a=function(e){var t=e.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var n=b(t);return document.body.removeChild(t),n}(e);a.width=Math.trunc(a.width)+1,a.height=Math.trunc(a.height)+1;var c={x:0,y:0};if(t instanceof Element){var d=b(t),u=d.x,s=d.width,l=d.y;c={x:"r"===v?u+s:u-a.width,y:l},t.className.includes("submenu")&&(c.y+="d"===y?4:-12);var h=g(a,c);c.x!==h.x&&(v="r"===v?"l":"r",c.x="r"===v?u+s:u-a.width),c.y!==h.y&&(y="u"===y?"d":"u",c.y=h.y),c=g(a,c)}else{var f=""!==document.body.style.transform?document.body.getBoundingClientRect():{x:0,y:0};c=g(a,{x:(t.clientX-f.x)/n.x,y:(t.clientY-f.y)/n.y})}Object.assign(e.style,{left:c.x+"px",top:c.y+"px",width:a.width+"px",height:a.height+"px"})}function g(e,t){var n=window.visualViewport,o=n.width,i=n.height,r=""!==document.body.style.transform?document.body.getBoundingClientRect():{left:0,top:0},a=r.left,c=r.top,d=w(),u=-a/d.x,s=-c/d.y,l=(o-a)/d.x,h=(i-c)/d.y;return{x:"r"===v?t.x+e.width>l?l-e.width:t.x:t.x<u?u:t.x,y:"d"===y?t.y+e.height>h?h-e.height:t.y:t.y<s?s:t.y}}function b(e){var t=e.offsetLeft,n=e.offsetTop,o=e.offsetHeight,i=e.offsetWidth;if(e.offsetParent instanceof HTMLElement){var r=b(e.offsetParent);return{x:t+r.x,y:n+r.y,width:i,height:o}}return{x:t,y:n,width:i,height:o}}function w(){var e=document.body,t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth,y:t.height/e.offsetHeight}}var E=function(){function o(){var e=this;this.cache={},this.preventCloseOnScroll=!1,window.addEventListener("click",(function(t){var n=t.target instanceof Element&&t.target.parentElement;n&&"interactive"===n.className||e.hide()})),window.addEventListener("resize",(function(){e.hide()}));var t=0;window.addEventListener("wheel",(function(){clearTimeout(t),t=setTimeout((function(){e.preventCloseOnScroll?e.preventCloseOnScroll=!1:e.hide()}))}),{passive:!0}),window.addEventListener("keydown",(function(t){"Escape"===t.key&&e.hide()})),o.addStylesToDom()}return o.getInstance=function(){o.instance||(o.instance=new o);var e=o.instance;return{attach:e.attach.bind(e),delete:e.delete.bind(e),hide:e.hide.bind(e),show:e.show.bind(e),update:e.update.bind(e)}},o.prototype.attach=function(t,n,o){var i=this;void 0===o&&(o=function(e){return e});var r=document.querySelector(t);if(void 0===this.cache[t])if(r){var a=function(t){var r=o(e([],n,!0),t);i.show(r,t)};this.cache[t]={ctxMenu:n,handler:a,beforeRender:o},r.addEventListener("contextmenu",a)}else console.error("target element ".concat(t," not found"));else console.error("target element ".concat(t," already has a context menu assigned. Use ContextMenu.update() intstead."))},o.prototype.update=function(e,t,n){var o=this.cache[e],i=document.querySelector(e);o&&(null==i||i.removeEventListener("contextmenu",o.handler)),delete this.cache[e],this.attach(e,t||(null==o?void 0:o.ctxMenu)||[],n||(null==o?void 0:o.beforeRender))},o.prototype.delete=function(e){var t=this.cache[e];if(!t)return console.error("no context menu for target element ".concat(e," found"));delete this.cache[e];var n=document.querySelector(e);if(!n)return console.error("target element ".concat(e," does not exist (anymore)"));n.removeEventListener("contextmenu",t.handler)},o.prototype.show=function(t,n){var o=this;n instanceof MouseEvent&&n.stopImmediatePropagation(),this.hide(),this.menu=this.generateDOM(e([],t,!0),n),document.body.appendChild(this.menu),this.menu.addEventListener("wheel",(function(){o.preventCloseOnScroll=!0}),{passive:!0}),n instanceof MouseEvent&&n.preventDefault()},o.prototype.hide=function(e){var t;void 0===e&&(e=this.menu),v="r",y="d",e&&(e===this.menu&&delete this.menu,null===(t=e.parentElement)||void 0===t||t.removeChild(e))},o.prototype.generateDOM=function(e,o){var i=this,c=document.createElement("ul");return 0===e.length&&(c.style.display="none"),e.forEach((function(e){var o=function(e){var t=document.createElement("li");return function(e,t,n){e.filter((function(e){return(0,e[0])(t)})).every((function(e){e[0];var t=e[1],o=e[2];return!void n.classList.add(t)&&o}))}([[r,"divider",!1],[function(e){return e.icon},"icon",!0],[d,"heading",!1],[a,"submenu",!0],[u,"disabled",!1],[n,"interactive",!0]],e,t),r(e)||[l,h,f,p,m].forEach((function(n){return n.call(null,e,t)})),t}(e);s(o,(function(){var e,t=null===(e=o.parentElement)||void 0===e?void 0:e.querySelector("ul");t&&t.parentElement!==o&&i.hide(t)})),n(e)&&!u(e)&&(a(e)?s(o,(function(n){o.querySelector("ul")||i.openSubMenu(n,t(e.subMenu),o)})):o.addEventListener("click",(function(){i.hide()}))),c.appendChild(o)})),c.className="ctxmenu",x(c,o),c.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),c.addEventListener("click",(function(e){var t=e.target instanceof Element&&e.target.parentElement;t&&"interactive"!==t.className&&e.stopPropagation()})),c},o.prototype.openSubMenu=function(e,t,n){var o,i=null===(o=n.parentElement)||void 0===o?void 0:o.querySelector("li > ul");i&&i.parentElement!==n&&this.hide(i),n.appendChild(this.generateDOM(t,n))},o.addStylesToDom=function(){if("loading"===document.readyState)return document.addEventListener("readystatechange",this.addStylesToDom,{once:!0});var e=document.createElement("style");e.innerHTML='html{min-height:100%}.ctxmenu{position:fixed;border:1px solid #999;padding:2px 0;box-shadow:#aaa 3px 3px 3px;background:#fff;margin:0;z-index:9999;overflow-y:auto;font:15px Verdana, sans-serif;box-sizing:border-box}.ctxmenu li{margin:1px 0;display:block;position:relative;user-select:none}.ctxmenu li.heading{font-weight:bold;margin-left:-5px}.ctxmenu li span{display:block;padding:2px 20px;cursor:default}.ctxmenu li a{color:inherit;text-decoration:none}.ctxmenu li.icon{padding-left:15px}.ctxmenu img.icon{position:absolute;width:18px;left:10px;top:2px}.ctxmenu li.disabled{color:#ccc}.ctxmenu li.divider{border-bottom:1px solid #aaa;margin:5px 0}.ctxmenu li.interactive:hover{background:rgba(0, 0, 0, .1)}.ctxmenu li.submenu::after{content:"";position:absolute;display:block;top:0;bottom:0;right:.4em;margin:auto .1rem auto auto;border-right:1px solid #000;border-top:1px solid #000;transform:rotate(45deg);width:.3rem;height:.3rem}.ctxmenu li.submenu.disabled::after{border-color:#ccc}',document.head.insertBefore(e,document.head.childNodes[0])},o}().getInstance();
/*! ctxMenu v1.6.1 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/exports.ctxmenu=E;
