"use strict";function n(n){return"function"==typeof n?n():n}function t(n){return e(n)||i(n)||u(n)}function e(n){return n.hasOwnProperty("action")}function i(n){return n.hasOwnProperty("href")}function o(n){return n.hasOwnProperty("isDivider")}function u(n){return n.hasOwnProperty("subMenu")}function r(n){return!t(n)&&!o(n)&&!function(n){return n.hasOwnProperty("html")||n.hasOwnProperty("element")}(n)}function c(e){return t(e)&&n(e.disabled)||u(e)&&0===n(e.subMenu).length}function a(n,t){var e;n.addEventListener("mouseenter",(function(n){e=setTimeout((function(){return t(n)}),150)})),n.addEventListener("mouseleave",(function(){return clearTimeout(e)}))}function d(n){var e=document.createElement("li");return function(n,t,e){n.filter((function(n){return(0,n[0])(t)})).every((function(n){n[0];var t=n[1],i=n[2];return!void e.classList.add(t)&&i}))}([[o,"divider",!1],[function(n){return n.icon},"icon",!0],[r,"heading",!1],[u,"submenu",!0],[c,"disabled",!1],[t,"interactive",!0]],n,e),o(n)||[s,l,f,v,m].forEach((function(t){return t.call(null,n,e)})),e}function s(t,e){var i,o=t.html,u=t.text,r=n(t.element);r?e.append(r):e.innerHTML=null!==(i=n(o))&&void 0!==i?i:"<span>".concat(n(u),"</span>")}function l(t,e){var i=t.tooltip,o=t.style,u=t.attributes;e.title=n(i)||"",o&&e.setAttribute("style",n(o)),u&&Object.entries(n(u)).forEach((function(n){var t=n[0],i=n[1];e.setAttribute(t,i)}))}function f(t,e){var i=t.icon;i&&(e.innerHTML+='<img class="icon" src="'.concat(n(i),'" />'))}function v(i,o){for(var r=0,a=Object.entries(n(i.events)||{});r<a.length;r++){var d=a[r],s=d[0],l=d[1],f="function"==typeof l?{listener:l,options:{}}:l,v=f.listener,m=f.options;o.addEventListener(s,v,m)}o.addEventListener("click",(function(n){c(i)||u(i)||(e(i)&&i.action(n),t(i)&&y.hide())}))}function m(t,e){if(i(t)&&!c(t)){var o=t.href,u=t.download,r=t.target,a=document.createElement("a");a.innerHTML=e.innerHTML,a.href=n(o),void 0!==u&&(a.download=n(u)),r&&(a.target=n(r)),e.replaceChildren(a)}}Object.defineProperty(exports,"t",{value:!0});var h="r",x="d";function p(n,t){var e=w(),i=window.visualViewport,o=i.width,u=i.height;Object.assign(n.style,{maxHeight:u/e.y+"px",maxWidth:o/e.x+"px"});var r=function(n){var t=n.cloneNode(!0);t.style.visibility="hidden",document.body.appendChild(t);var e=g(t);return document.body.removeChild(t),e}(n);r.width=Math.trunc(r.width)+1,r.height=Math.trunc(r.height)+1;var c={x:0,y:0};if(t instanceof Element){var a=g(t),d=a.x,s=a.width,l=a.y;c={x:"r"===h?d+s:d-r.width,y:l},t.className.includes("submenu")&&(c.y+="d"===x?4:-12);var f=b(r,c);c.x!==f.x&&(h="r"===h?"l":"r",c.x="r"===h?d+s:d-r.width),c.y!==f.y&&(x="u"===x?"d":"u",c.y=f.y),c=b(r,c)}else{var v=""!==document.body.style.transform?document.body.getBoundingClientRect():{x:0,y:0};c=b(r,{x:(t.clientX-v.x)/e.x,y:(t.clientY-v.y)/e.y})}Object.assign(n.style,{left:c.x+"px",top:c.y+"px",width:r.width+"px",height:r.height+"px"})}function b(n,t){var e=window.visualViewport,i=e.width,o=e.height,u=""!==document.body.style.transform?document.body.getBoundingClientRect():{left:0,top:0},r=u.left,c=u.top,a=w(),d=-r/a.x,s=-c/a.y,l=(i-r)/a.x,f=(o-c)/a.y;return{x:"r"===h?t.x+n.width>l?l-n.width:t.x:t.x<d?d:t.x,y:"d"===x?t.y+n.height>f?f-n.height:t.y:t.y<s?s:t.y+n.height>f?f-n.height:t.y}}function g(n){var t=n.offsetLeft,e=n.offsetTop,i=n.offsetHeight,o=n.offsetWidth;if(n.offsetParent instanceof HTMLElement){var u=g(n.offsetParent);return{x:t+u.x,y:e+u.y,width:o,height:i}}return{x:t,y:e,width:o,height:i}}function w(){var n=document.body,t=n.getBoundingClientRect();return{x:t.width/n.offsetWidth,y:t.height/n.offsetHeight}}var y=function(){function t(){var n=this;this.cache={},this.o=!1,window.addEventListener("click",(function(){n.hide()})),window.addEventListener("resize",(function(){n.hide()}));var e=0;window.addEventListener("wheel",(function(){clearTimeout(e),e=setTimeout((function(){n.o?n.o=!1:n.hide()}))}),{passive:!0}),window.addEventListener("keydown",(function(t){"Escape"===t.key&&n.hide()})),t.u()}return t.i=function(){t.l||(t.l=new t);var n=t.l;return{attach:n.v.bind(n),delete:n.delete.bind(n),hide:n.hide.bind(n),show:n.show.bind(n),update:n.update.bind(n)}},t.prototype.v=function(n,t,e){var i=this;void 0===e&&(e={});var o=document.querySelector(n);if(void 0===this.cache[n])if(o){var u=function(n){i.show(t,n,e)};this.cache[n]={m:t,h:u,p:e},o.addEventListener("contextmenu",u)}else console.error("target element ".concat(n," not found"));else console.error("target element ".concat(n," already has a context menu assigned. Use ContextMenu.update() intstead."))},t.prototype.update=function(n,t,e){void 0===e&&(e={});var i=this.cache[n],o=Object.assign({},null==i?void 0:i.p,e),u=document.querySelector(n);i&&(null==u||u.removeEventListener("contextmenu",i.h)),delete this.cache[n],this.v(n,t||(null==i?void 0:i.m)||[],o)},t.prototype.delete=function(n){var t=this.cache[n];if(!t)return console.error("no context menu for target element ".concat(n," found"));delete this.cache[n];var e=document.querySelector(n);if(!e)return console.error("target element ".concat(n," does not exist (anymore)"));e.removeEventListener("contextmenu",t.h)},t.prototype.show=function(n,t,e){var i,o,u,r=this;void 0===e&&(e={}),t instanceof MouseEvent&&(t.stopImmediatePropagation(),t.preventDefault()),this.hide(),this.onHide=e.onHide,this.onBeforeHide=e.onBeforeHide;var c=null!==(o=null===(i=e.onBeforeShow)||void 0===i?void 0:i.call(e,n.slice(),t instanceof MouseEvent?t:void 0))&&void 0!==o?o:n;this.g=this.k(c,t,e.attributes),document.body.appendChild(this.g),null===(u=e.onShow)||void 0===u||u.call(e,this.g),this.g.addEventListener("wheel",(function(){r.o=!0}),{passive:!0})},t.prototype.hide=function(){this.M(this.g)},t.prototype.M=function(n){var t,e;null===(t=this.onBeforeHide)||void 0===t||t.call(this,n),h="r",x="d",n&&(n.remove(),null===(e=this.onHide)||void 0===e||e.call(this,n),n===this.g&&(delete this.g,this.onBeforeHide=void 0,this.onHide=void 0))},t.prototype.k=function(t,e,i){var o=this;void 0===i&&(i={});var r=function(n){var t=document.createElement("ul");return t.className="ctxmenu",t.append.apply(t,n.map(d)),n.length||(t.style.display="none"),t.addEventListener("contextmenu",(function(n){n.stopPropagation(),n.preventDefault()})),t.addEventListener("click",(function(n){n.stopPropagation()})),t}(t);return p(r,e),t.forEach((function(t,e){var i=r.children[e];a(i,(function(){var n,t=null===(n=i.parentElement)||void 0===n?void 0:n.querySelector("ul");t&&t.parentElement!==i&&o.M(t)})),c(t)||u(t)&&a(i,(function(){i.querySelector("ul")||i.appendChild(o.k(n(t.subMenu),i,n(t.subMenuAttributes)))}))})),Object.entries(i).forEach((function(n){var t=n[0],e=n[1];return r.setAttribute(t,e)})),r},t.u=function(){if("loading"===document.readyState)return document.addEventListener("readystatechange",this.u,{once:!0});var n=document.createElement("style");n.innerHTML='html{min-height:100%}.ctxmenu{position:fixed;border:1px solid #999;padding:2px 0;box-shadow:#aaa 3px 3px 3px;background:#fff;margin:0;z-index:9999;overflow-y:auto;font:15px Verdana,sans-serif;box-sizing:border-box}.ctxmenu li{margin:1px 0;display:block;position:relative;user-select:none}.ctxmenu li.heading{font-weight:bold;margin-left:-5px}.ctxmenu li span{display:block;padding:2px 20px;cursor:default}.ctxmenu li a{color:inherit;text-decoration:none}.ctxmenu li.icon{padding-left:15px}.ctxmenu img.icon{position:absolute;width:18px;left:10px;top:2px}.ctxmenu li.disabled{color:#ccc}.ctxmenu li.divider{border-bottom:1px solid #aaa;margin:5px 0}.ctxmenu li.interactive:hover{background:rgba(0,0,0,.1)}.ctxmenu li.submenu::after{content:"";position:absolute;display:block;top:0;bottom:0;right:.4em;margin:auto .1rem auto auto;border:solid #000;border-width:1px 1px 0 0;transform:rotate(45deg);width:.3rem;height:.3rem}.ctxmenu li.submenu.disabled::after{border-color:#ccc}',document.head.insertBefore(n,document.head.childNodes[0])},t}().i();
/*! ctxMenu v2.0.0 | (c) Nikolaj Kappler | https://github.com/nkappler/ctxmenu/blob/master/LICENSE !*/exports.ctxmenu=y;
